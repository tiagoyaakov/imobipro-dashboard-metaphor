import React from 'react';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { Progress } from '@/components/ui/progress';\nimport { \n  BarChart3, \n  MessageSquare, \n  Clock, \n  TrendingUp,\n  Users,\n  Star,\n  Calendar,\n  FileText\n} from 'lucide-react';\nimport { cn } from '@/lib/utils';\nimport { ChatAnalytics as ChatAnalyticsType } from '@/types/leiInquilino';\n\ninterface ChatAnalyticsProps {\n  analytics: ChatAnalyticsType;\n  className?: string;\n}\n\nconst ChatAnalytics: React.FC<ChatAnalyticsProps> = ({ analytics, className }) => {\n  const formatDuration = (milliseconds: number) => {\n    const seconds = Math.round(milliseconds / 1000);\n    if (seconds < 60) return `${seconds}s`;\n    const minutes = Math.floor(seconds / 60);\n    const remainingSeconds = seconds % 60;\n    return `${minutes}m ${remainingSeconds}s`;\n  };\n\n  const getTopCategory = () => {\n    return analytics.popularCategories.reduce((top, category) => \n      category.count > top.count ? category : top\n    , analytics.popularCategories[0] || { category: 'N/A', count: 0, percentage: 0 });\n  };\n\n  const topCategory = getTopCategory();\n\n  return (\n    <div className={cn(\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\", className)}>\n      {/* Total Sessions */}\n      <Card className=\"p-4\">\n        <div className=\"flex items-center gap-3\">\n          <div className=\"w-10 h-10 rounded-lg bg-blue-100 dark:bg-blue-900/20 flex items-center justify-center\">\n            <MessageSquare className=\"w-5 h-5 text-blue-600\" />\n          </div>\n          <div>\n            <p className=\"text-sm text-muted-foreground\">Total de Sessões</p>\n            <p className=\"text-2xl font-bold\">{analytics.totalSessions}</p>\n            <div className=\"flex items-center gap-1 text-sm\">\n              <span className=\"text-green-600\">{analytics.activeSessions}</span>\n              <span className=\"text-muted-foreground\">ativas</span>\n            </div>\n          </div>\n        </div>\n      </Card>\n\n      {/* Response Time */}\n      <Card className=\"p-4\">\n        <div className=\"flex items-center gap-3\">\n          <div className=\"w-10 h-10 rounded-lg bg-orange-100 dark:bg-orange-900/20 flex items-center justify-center\">\n            <Clock className=\"w-5 h-5 text-orange-600\" />\n          </div>\n          <div>\n            <p className=\"text-sm text-muted-foreground\">Tempo de Resposta</p>\n            <p className=\"text-2xl font-bold\">\n              {formatDuration(analytics.averageResponseTime)}\n            </p>\n            <div className=\"flex items-center gap-1 text-sm\">\n              <TrendingUp className=\"w-3 h-3 text-green-600\" />\n              <span className=\"text-green-600\">Rápido</span>\n            </div>\n          </div>\n        </div>\n      </Card>\n\n      {/* User Satisfaction */}\n      <Card className=\"p-4\">\n        <div className=\"flex items-center gap-3\">\n          <div className=\"w-10 h-10 rounded-lg bg-yellow-100 dark:bg-yellow-900/20 flex items-center justify-center\">\n            <Star className=\"w-5 h-5 text-yellow-600\" />\n          </div>\n          <div>\n            <p className=\"text-sm text-muted-foreground\">Satisfação</p>\n            <p className=\"text-2xl font-bold\">\n              {analytics.userSatisfaction.average.toFixed(1)}\n            </p>\n            <div className=\"flex items-center gap-1 text-sm\">\n              <span className=\"text-muted-foreground\">\n                {analytics.userSatisfaction.total} avaliações\n              </span>\n            </div>\n          </div>\n        </div>\n      </Card>\n\n      {/* Top Category */}\n      <Card className=\"p-4\">\n        <div className=\"flex items-center gap-3\">\n          <div className=\"w-10 h-10 rounded-lg bg-purple-100 dark:bg-purple-900/20 flex items-center justify-center\">\n            <BarChart3 className=\"w-5 h-5 text-purple-600\" />\n          </div>\n          <div>\n            <p className=\"text-sm text-muted-foreground\">Categoria Popular</p>\n            <p className=\"text-lg font-bold truncate\">\n              {topCategory.category}\n            </p>\n            <div className=\"flex items-center gap-1 text-sm\">\n              <span className=\"text-purple-600\">\n                {topCategory.percentage.toFixed(0)}%\n              </span>\n              <span className=\"text-muted-foreground\">\n                ({topCategory.count} consultas)\n              </span>\n            </div>\n          </div>\n        </div>\n      </Card>\n\n      {/* Categories Breakdown */}\n      <Card className=\"md:col-span-2 lg:col-span-4\">\n        <CardHeader className=\"pb-4\">\n          <CardTitle className=\"text-lg flex items-center gap-2\">\n            <FileText className=\"w-5 h-5\" />\n            Distribuição por Categoria\n          </CardTitle>\n        </CardHeader>\n        <CardContent>\n          <div className=\"space-y-4\">\n            {analytics.popularCategories.map((category, index) => {\n              const colors = [\n                'bg-blue-500',\n                'bg-purple-500', \n                'bg-orange-500',\n                'bg-green-500',\n                'bg-red-500'\n              ];\n              \n              return (\n                <div key={index} className=\"space-y-2\">\n                  <div className=\"flex items-center justify-between\">\n                    <div className=\"flex items-center gap-2\">\n                      <div className={cn(\n                        \"w-3 h-3 rounded-full\",\n                        colors[index % colors.length]\n                      )} />\n                      <span className=\"text-sm font-medium\">\n                        {category.category}\n                      </span>\n                    </div>\n                    <div className=\"flex items-center gap-2\">\n                      <Badge variant=\"secondary\" className=\"text-xs\">\n                        {category.count}\n                      </Badge>\n                      <span className=\"text-sm text-muted-foreground\">\n                        {category.percentage.toFixed(1)}%\n                      </span>\n                    </div>\n                  </div>\n                  <Progress \n                    value={category.percentage} \n                    className=\"h-2\" \n                  />\n                </div>\n              );\n            })}\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* Satisfaction Ratings */}\n      <Card className=\"md:col-span-2\">\n        <CardHeader className=\"pb-4\">\n          <CardTitle className=\"text-lg flex items-center gap-2\">\n            <Star className=\"w-5 h-5\" />\n            Avaliações de Satisfação\n          </CardTitle>\n        </CardHeader>\n        <CardContent>\n          <div className=\"space-y-3\">\n            {analytics.userSatisfaction.ratings.map((rating, index) => {\n              const stars = 5 - index; // Assumindo ordem decrescente\n              const percentage = analytics.userSatisfaction.total > 0 \n                ? (rating.count / analytics.userSatisfaction.total) * 100 \n                : 0;\n              \n              return (\n                <div key={stars} className=\"flex items-center gap-3\">\n                  <div className=\"flex items-center gap-1 min-w-[60px]\">\n                    {Array.from({ length: stars }).map((_, i) => (\n                      <Star key={i} className=\"w-3 h-3 fill-yellow-400 text-yellow-400\" />\n                    ))}\n                  </div>\n                  <div className=\"flex-1\">\n                    <Progress value={percentage} className=\"h-2\" />\n                  </div>\n                  <div className=\"text-sm text-muted-foreground min-w-[40px] text-right\">\n                    {rating.count}\n                  </div>\n                </div>\n              );\n            })}\n          </div>\n          \n          <div className=\"mt-4 pt-4 border-t\">\n            <div className=\"flex items-center justify-between text-sm\">\n              <span className=\"text-muted-foreground\">Média geral:</span>\n              <div className=\"flex items-center gap-1\">\n                <Star className=\"w-4 h-4 fill-yellow-400 text-yellow-400\" />\n                <span className=\"font-semibold\">\n                  {analytics.userSatisfaction.average.toFixed(1)}\n                </span>\n                <span className=\"text-muted-foreground\">\n                  / 5.0\n                </span>\n              </div>\n            </div>\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* Usage Stats */}\n      <Card className=\"md:col-span-2\">\n        <CardHeader className=\"pb-4\">\n          <CardTitle className=\"text-lg flex items-center gap-2\">\n            <Calendar className=\"w-5 h-5\" />\n            Estatísticas de Uso\n          </CardTitle>\n        </CardHeader>\n        <CardContent>\n          <div className=\"grid grid-cols-2 gap-4\">\n            <div className=\"text-center p-3 bg-muted/30 rounded-lg\">\n              <div className=\"text-2xl font-bold text-blue-600\">\n                {Math.round(analytics.totalSessions / 30)}\n              </div>\n              <div className=\"text-sm text-muted-foreground\">\n                Sessões/dia (média)\n              </div>\n            </div>\n            \n            <div className=\"text-center p-3 bg-muted/30 rounded-lg\">\n              <div className=\"text-2xl font-bold text-green-600\">\n                {formatDuration(analytics.averageResponseTime)}\n              </div>\n              <div className=\"text-sm text-muted-foreground\">\n                Tempo médio\n              </div>\n            </div>\n            \n            <div className=\"text-center p-3 bg-muted/30 rounded-lg\">\n              <div className=\"text-2xl font-bold text-purple-600\">\n                {analytics.activeSessions}\n              </div>\n              <div className=\"text-sm text-muted-foreground\">\n                Sessões ativas\n              </div>\n            </div>\n            \n            <div className=\"text-center p-3 bg-muted/30 rounded-lg\">\n              <div className=\"text-2xl font-bold text-orange-600\">\n                {((analytics.userSatisfaction.average / 5) * 100).toFixed(0)}%\n              </div>\n              <div className=\"text-sm text-muted-foreground\">\n                Taxa satisfação\n              </div>\n            </div>\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  );\n};\n\nexport default ChatAnalytics;